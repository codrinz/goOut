{"version":3,"sources":["webpack:///webpack/bootstrap 25872869657e4c314b14","webpack:///./src/index.js","webpack:///./~/babel-runtime/regenerator/index.js","webpack:///external \"http\"","webpack:///external \"koa\"","webpack:///external \"koa-bodyparser\"","webpack:///external \"koa-cors\"","webpack:///external \"koa-router\"","webpack:///external \"regenerator-runtime\"","webpack:///external \"ws\""],"names":["Koa","require","app","server","createServer","callback","WebSocket","wss","Server","Router","cors","bodyparser","use","ctx","next","start","Date","ms","console","log","method","url","response","status","shows","router","broadcast","data","clients","forEach","client","readyState","OPEN","send","JSON","stringify","get","body","post","headers","request","sid","showName","day","month","freeSpots","allSpots","index","findIndex","show","push","text","routes","allowedMethods","listen"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 9);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 25872869657e4c314b14","const Koa = require('koa');\r\nconst app = new Koa();\r\nconst server = require('http').createServer(app.callback());\r\nconst WebSocket = require('ws');\r\nconst wss = new WebSocket.Server({server});\r\nconst Router = require('koa-router');\r\nconst cors = require('koa-cors');\r\nconst bodyparser = require('koa-bodyparser');\r\n\r\napp.use(bodyparser());\r\napp.use(cors());\r\napp.use(async function (ctx, next) {\r\n    const start = new Date();\r\n    await next();\r\n    const ms = new Date() - start;\r\n    console.log(`${ctx.method} ${ctx.url} ${ctx.response.status} - ${ms}ms`);\r\n});\r\n\r\nconst shows = [];\r\n\r\nconst router = new Router();\r\n\r\nconst broadcast = (data) =>\r\n    wss.clients.forEach((client) => {\r\n        if (client.readyState === WebSocket.OPEN) {\r\n            client.send(JSON.stringify(data));\r\n        }\r\n    });\r\n\r\nrouter.get('/testConnection',ctx => {\r\n    ctx.response.body = \"good\";\r\n    ctx.response.status = 200;\r\n});\r\n\r\nrouter.post('/add', ctx => {\r\n    const headers = ctx.request.body;\r\n    console.log(\"body: \" + JSON.stringify(headers));\r\n    const sid = headers.sid;\r\n    const showName = headers.showName;\r\n    const day = headers.day;\r\n    const month = headers.month;\r\n    const freeSpots = headers.freeSpots;\r\n    const allSpots = headers.allSpots;\r\n    if(typeof showName != 'undefined' || typeof day != 'undefined' || typeof month != 'undefined' || typeof freeSpots != 'undefined' || typeof allSpots != 'undefined'){\r\n        const index = shows.findIndex(show => show.sid === sid);\r\n        if(index === -1){\r\n            let show = {\r\n                sid,\r\n                showName,\r\n                day,\r\n                month,\r\n                freeSpots,\r\n                allSpots\r\n            };\r\n            shows.push(show);\r\n            broadcast(show);\r\n            ctx.response.body = show;\r\n            ctx.response.status = 200;\r\n        }else{\r\n            ctx.response.body = {text: 'The show already exists'};\r\n            ctx.response.status = 404;\r\n        }\r\n    }else{\r\n        ctx.response.body = {text: 'Missing data'};\r\n        ctx.response.status = 404;\r\n    }\r\n}\r\n)\r\n\r\napp.use(router.routes());\r\napp.use(router.allowedMethods());\r\n\r\nserver.listen(3000);\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","module.exports = require(\"regenerator-runtime\");\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/regenerator/index.js\n// module id = 1\n// module chunks = 0","module.exports = require(\"http\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"http\"\n// module id = 2\n// module chunks = 0","module.exports = require(\"koa\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa\"\n// module id = 3\n// module chunks = 0","module.exports = require(\"koa-bodyparser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-bodyparser\"\n// module id = 4\n// module chunks = 0","module.exports = require(\"koa-cors\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-cors\"\n// module id = 5\n// module chunks = 0","module.exports = require(\"koa-router\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-router\"\n// module id = 6\n// module chunks = 0","module.exports = require(\"regenerator-runtime\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"regenerator-runtime\"\n// module id = 7\n// module chunks = 0","module.exports = require(\"ws\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"ws\"\n// module id = 8\n// module chunks = 0"],"sourceRoot":""}